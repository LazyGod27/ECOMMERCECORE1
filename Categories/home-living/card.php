<?php
$products = [
    //Product 1
    [
        'name' => 'Decorative Throw Pillow Set',
        'price' => '₱100.00',
        'image' => '../../image/home-living/Decorative Throw Pillow Set.jpeg',
        'link' => 'view-product.php?id=501',
        'discount' => '-20%',
        'variants' => [
            'Gray' => 'https://via.placeholder.com/400x400/a9a9a9/999999?text=Gray',
            'Navy' => 'https://via.placeholder.com/400x400/000080/0000cc?text=Navy',
            'Beige' => 'https://via.placeholder.com/400x400/f5f5dc/ffff99?text=Beige'
        ],
        'description' => 'Stylish decorative throw pillows to brighten any room. Comfortable and durable fabric perfect for sofas and beds.',
        'reviews' => [
            [
                'reviewer_name' => 'Eleanor Chapman',
                'rating' => 5,
                'comment' => 'Beautiful pillows! Great colors and very soft. Perfect for my living room makeover!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Walter Mitchell',
                'rating' => 5,
                'comment' => 'Excellent quality throw pillows. Durable fabric and nice stitching. Very happy!',
                'date' => '1 month ago'
            ],
            [
                'reviewer_name' => 'Mabel Rodriguez',
                'rating' => 4,
                'comment' => 'Nice pillows but cover might shrink. Quality is still good though.',
                'date' => '2 months ago'
            ]
        ]
    ],

    //Product 2
    [
        'name' => 'Aromatherapy Scented Candles',
        'price' => '₱340.00',
        'image' => '../../image/home-living/Aromatherapy Scented Candles.jpeg',
        'link' => 'view-product.php?id=502',
        'discount' => '-20%',
        'variants' => [
            'Lavender' => 'https://via.placeholder.com/400x400/e6e6fa/cc99ff?text=Lavender',
            'Rose' => 'https://via.placeholder.com/400x400/ffb6c1/ff99bb?text=Rose',
            'Vanilla' => 'https://via.placeholder.com/400x400/f5deb3/ffcc99?text=Vanilla'
        ],
        'description' => 'Soothing aromatherapy candles with natural scents. Perfect for relaxation and creating a calm ambiance in any room.',
        'reviews' => [
            [
                'reviewer_name' => 'Audrey Green',
                'rating' => 5,
                'comment' => 'Amazing scented candles! The aroma fills the entire room. Very relaxing and high quality!',
                'date' => '3 weeks ago'
            ],
            [
                'reviewer_name' => 'George Lopez',
                'rating' => 5,
                'comment' => 'Excellent candles! Burns evenly and scent is wonderful. Perfect for meditation!',
                'date' => '1 month ago'
            ],
            [
                'reviewer_name' => 'Phyllis Brown',
                'rating' => 4,
                'comment' => 'Good candles with nice scent. Maybe a tiny bit overpriced but quality is nice.',
                'date' => '2 months ago'
            ]
        ]
    ],

    //Product 3
    [
        'name' => 'Non-Slip Floor Mat - Rug',
        'price' => '₱50.00',
        'image' => '../../image/home-living/Non-Slip Floor Mat - Rug.jpeg',
        'link' => 'view-product.php?id=503',
        'discount' => '-20%',
        'variants' => [
            'Brown' => 'https://via.placeholder.com/400x400/8b6f47/996633?text=Brown',
            'Gray' => 'https://via.placeholder.com/400x400/a9a9a9/999999?text=Gray',
            'Black' => 'https://via.placeholder.com/400x400/1a1a1a/333333?text=Black'
        ],
        'description' => 'Durable non-slip floor mat with soft pile. Great for kitchens, bathrooms, and bedrooms for comfort and safety.',
        'reviews' => [
            [
                'reviewer_name' => 'Evelyn Garcia',
                'rating' => 5,
                'comment' => 'Perfect floor mat! Very non-slip and super soft. Safe and comfortable!',
                'date' => '1 week ago'
            ],
            [
                'reviewer_name' => 'Fred Wilson',
                'rating' => 5,
                'comment' => 'Great mat! Doesn\'t slide at all and feels good underfoot. High quality!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Joyce Martinez',
                'rating' => 4,
                'comment' => 'Good mat with strong grip. Sheds a bit initially but holds up well.',
                'date' => '1 month ago'
            ]
        ]
    ],

    //Product 4
    [
        'name' => 'Wall Art Canvas Frame',
        'price' => '₱1,500.00',
        'image' => '../../image/home-living/Wall Art Canvas Frame.jpeg',
        'link' => 'view-product.php?id=504',
        'discount' => '-20%',
        'variants' => [
            'Black' => 'https://via.placeholder.com/400x400/1a1a1a/333333?text=Black',
            'White' => 'https://via.placeholder.com/400x400/f5f5f5/cccccc?text=White',
            'Brown' => 'https://via.placeholder.com/400x400/8b6f47/996633?text=Brown'
        ],
        'description' => 'Beautiful wall art canvas with quality framing. Perfect for adding artistic flair to any room decor.',
        'reviews' => [
            [
                'reviewer_name' => 'Diane Harris',
                'rating' => 5,
                'comment' => 'Beautiful canvas art! Looks professional and really enhances my wall. Great quality!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Gerald Jones',
                'rating' => 5,
                'comment' => 'Excellent wall art! Comes ready to hang and looks amazing. Very satisfied!',
                'date' => '1 month ago'
            ],
            [
                'reviewer_name' => 'Judith Young',
                'rating' => 4,
                'comment' => 'Nice art piece. Frame is good quality though colors slightly different than photo.',
                'date' => '2 months ago'
            ]
        ]
    ],

    //Product 5
    [
        'name' => 'LED Table Lamp (Touch Control)',
        'price' => '₱2,500.00',
        'image' => '../../image/home-living/LED Table Lamp (Touch Control).jpeg',
        'link' => 'view-product.php?id=505',
        'discount' => '-20%',
        'variants' => [
            'Black' => 'https://via.placeholder.com/400x400/1a1a1a/333333?text=Black',
            'Silver' => 'https://via.placeholder.com/400x400/c0c0c0/999999?text=Silver',
            'Gold' => 'https://via.placeholder.com/400x400/ffd700/ffcc00?text=Gold'
        ],
        'description' => 'Modern LED table lamp with convenient touch control and energy-efficient lighting. Perfect for reading and desk work.',
        'reviews' => [
            [
                'reviewer_name' => 'Lillian Clark',
                'rating' => 5,
                'comment' => 'Great lamp! Touch control is very convenient and the light is perfect for reading!',
                'date' => '3 weeks ago'
            ],
            [
                'reviewer_name' => 'Henry Roberts',
                'rating' => 5,
                'comment' => 'Excellent LED lamp! Modern design and very energy efficient. Love it!',
                'date' => '1 month ago'
            ],
            [
                'reviewer_name' => 'Doris Thompson',
                'rating' => 4,
                'comment' => 'Nice lamp with good lighting. Touch sensor sometimes slow to respond.',
                'date' => '2 months ago'
            ]
        ]
    ],

    //Product 6
    [
        'name' => 'Storage Basket Organizer',
        'price' => '₱10,200.00',
        'image' => '../../image/home-living/Storage Basket Organizer.jpeg',
        'link' => 'view-product.php?id=506',
        'discount' => '-20%',
        'variants' => [
            'Brown' => 'https://via.placeholder.com/400x400/8b6f47/996633?text=Brown',
            'Gray' => 'https://via.placeholder.com/400x400/a9a9a9/999999?text=Gray',
            'Natural' => 'https://via.placeholder.com/400x400/d2b48c/cc9966?text=Natural'
        ],
        'description' => 'Functional storage basket organizer for decluttering any room. Sturdy weave design with natural aesthetic.',
        'reviews' => [
            [
                'reviewer_name' => 'Emily Sullivan',
                'rating' => 5,
                'comment' => 'Perfect storage basket! Very sturdy and looks great. Helps keep my room organized!',
                'date' => '1 week ago'
            ],
            [
                'reviewer_name' => 'Kenneth Baker',
                'rating' => 5,
                'comment' => 'Great organizer! Spacious and well-made. Works perfectly for my needs!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Patricia Nelson',
                'rating' => 4,
                'comment' => 'Good storage basket. Slightly smaller than expected but well constructed.',
                'date' => '1 month ago'
            ]
        ]
    ],

    //Product 7
    [
        'name' => 'Ceramic Vase (Modern Design)',
        'price' => '₱15,000.00',
        'image' => '../../image/home-living/Ceramic Vase (Modern Design).jpeg',
        'link' => 'view-product.php?id=507',
        'discount' => '-20%',
        'variants' => [
            'White' => 'https://via.placeholder.com/400x400/f5f5f5/cccccc?text=White',
            'Gray' => 'https://via.placeholder.com/400x400/a9a9a9/999999?text=Gray',
            'Black' => 'https://via.placeholder.com/400x400/1a1a1a/333333?text=Black'
        ],
        'description' => 'Sleek modern ceramic vase perfect for contemporary home decor. Versatile size for displaying fresh or artificial flowers.',
        'reviews' => [
            [
                'reviewer_name' => 'Anna Murphy',
                'rating' => 5,
                'comment' => 'Beautiful modern vase! Great design and perfect for my flowers. Love it!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Frank Campbell',
                'rating' => 5,
                'comment' => 'Excellent ceramic vase! Very modern and adds elegant touch to my home!',
                'date' => '1 month ago'
            ],
            [
                'reviewer_name' => 'Ruth Martin',
                'rating' => 4,
                'comment' => 'Nice vase with good design. Slightly pricey for ceramic but quality is nice.',
                'date' => '2 months ago'
            ]
        ]
    ],

    //Product 8
    [
        'name' => 'Kitchen Spice Rack Organizer',
        'price' => '₱20,000.00',
        'image' => '../../image/home-living/Kitchen Spice Rack Organizer.jpeg',
        'link' => 'view-product.php?id=508',
        'discount' => '-20%',
        'variants' => [
            'Brown' => 'https://via.placeholder.com/400x400/8b6f47/996633?text=Brown',
            'Black' => 'https://via.placeholder.com/400x400/1a1a1a/333333?text=Black',
            'Natural' => 'https://via.placeholder.com/400x400/d2b48c/cc9966?text=Natural'
        ],
        'description' => 'Organized kitchen spice rack with multiple compartments. Keep spices accessible and your kitchen organized.',
        'reviews' => [
            [
                'reviewer_name' => 'Margaret Turner',
                'rating' => 5,
                'comment' => 'Perfect spice organizer! Makes cooking so much easier. Very functional!',
                'date' => '1 week ago'
            ],
            [
                'reviewer_name' => 'Steve Anderson',
                'rating' => 5,
                'comment' => 'Excellent rack! Keeps all my spices organized and easy to find. Highly recommend!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Helen Davis',
                'rating' => 4,
                'comment' => 'Good organizer but a bit small for large spice collections.',
                'date' => '1 month ago'
            ]
        ]
    ],

    //Product 9
    [
        'name' => 'Foldable Laundry Basket',
        'price' => '₱59,000.00',
        'image' => '../../image/home-living/Foldable Laundry Basket.jpeg',
        'link' => 'view-product.php?id=509',
        'discount' => '-20%',
        'variants' => [
            'Gray' => 'https://via.placeholder.com/400x400/a9a9a9/999999?text=Gray',
            'Navy' => 'https://via.placeholder.com/400x400/000080/0000cc?text=Navy',
            'Black' => 'https://via.placeholder.com/400x400/1a1a1a/333333?text=Black'
        ],
        'description' => 'Space-saving foldable laundry basket for easy storage. Durable construction with comfortable handles.',
        'reviews' => [
            [
                'reviewer_name' => 'Carol Mitchell',
                'rating' => 5,
                'comment' => 'Great laundry basket! Folds up nicely and stays sturdy when in use. Very practical!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'David Johnson',
                'rating' => 5,
                'comment' => 'Perfect foldable basket! Saves space and very durable. Love this product!',
                'date' => '1 month ago'
            ],
            [
                'reviewer_name' => 'Lisa White',
                'rating' => 4,
                'comment' => 'Good laundry basket but handles could be stronger.',
                'date' => '2 months ago'
            ]
        ]
    ],

    //Product 10
    [
        'name' => 'Electric Kettle (1.7L)',
        'price' => '₱100.00',
        'image' => '../../image/home-living/Electric Kettle (1.7L).jpeg',
        'link' => 'view-product.php?id=510',
        'discount' => '-20%',
        'variants' => [
            'Black' => 'https://via.placeholder.com/400x400/1a1a1a/333333?text=Black',
            'Silver' => 'https://via.placeholder.com/400x400/c0c0c0/999999?text=Silver',
            'White' => 'https://via.placeholder.com/400x400/f5f5f5/cccccc?text=White'
        ],
        'description' => 'Fast and efficient electric kettle with auto shut-off feature. Boils water quickly for tea, coffee, and cooking.',
        'reviews' => [
            [
                'reviewer_name' => 'Sandra Scott',
                'rating' => 5,
                'comment' => 'Excellent kettle! Boils water very fast and auto shut-off is great. Perfect for daily use!',
                'date' => '1 week ago'
            ],
            [
                'reviewer_name' => 'James Green',
                'rating' => 5,
                'comment' => 'Great electric kettle! Very reliable and heats water efficiently. Highly recommend!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Betty Adams',
                'rating' => 4,
                'comment' => 'Good kettle but slightly loud when boiling. Works well overall!',
                'date' => '1 month ago'
            ]
        ]
    ],

    //Product 11
    [
        'name' => 'Bedside Alarm Clock (Digital)',
        'price' => '₱1,000.00',
        'image' => '../../image/home-living/Bedside Alarm Clock (Digital).jpeg',
        'link' => 'view-product.php?id=511',
        'discount' => '-20%',
        'variants' => [
            'Black' => 'https://via.placeholder.com/400x400/1a1a1a/333333?text=Black',
            'White' => 'https://via.placeholder.com/400x400/f5f5f5/cccccc?text=White',
            'Silver' => 'https://via.placeholder.com/400x400/c0c0c0/999999?text=Silver'
        ],
        'description' => 'Reliable digital bedside alarm clock with clear display and snooze function. Essential for a good morning routine.',
        'reviews' => [
            [
                'reviewer_name' => 'Christine Harris',
                'rating' => 5,
                'comment' => 'Perfect alarm clock! Easy to read at night and alarm is loud. Great quality!',
                'date' => '3 weeks ago'
            ],
            [
                'reviewer_name' => 'Richard Bennett',
                'rating' => 5,
                'comment' => 'Excellent clock! Reliable and keeps good time. Perfect for bedsidestart!',
                'date' => '1 month ago'
            ],
            [
                'reviewer_name' => 'Michelle Edwards',
                'rating' => 4,
                'comment' => 'Good alarm clock. Buttons could be easier to use in dark but works well.',
                'date' => '2 months ago'
            ]
        ]
    ],

    //Product 12
    [
        'name' => 'Multi-Purpose Storage Box',
        'price' => '₱100.00',
        'image' => '../../image/home-living/Multi-Purpose Storage Box.jpeg',
        'link' => 'view-product.php?id=512',
        'discount' => '-20%',
        'variants' => [
            'Small' => 'https://via.placeholder.com/400x400/a9a9a9/999999?text=Small',
            'Medium' => 'https://via.placeholder.com/400x400/d3d3d3/999999?text=Medium',
            'Large' => 'https://via.placeholder.com/400x400/808080/999999?text=Large'
        ],
        'description' => 'Versatile storage box for organizing various items in your home. Stackable design for space-efficient storage.',
        'reviews' => [
            [
                'reviewer_name' => 'Victoria Hughes',
                'rating' => 5,
                'comment' => 'Great storage boxes! Perfect for organizing my home and stackable design is smart!',
                'date' => '1 week ago'
            ],
            [
                'reviewer_name' => 'Charles Taylor',
                'rating' => 5,
                'comment' => 'Excellent storage solution! Well made and very functional. Love them!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Grace Cooper',
                'rating' => 4,
                'comment' => 'Good storage boxes. Slightly less sturdy than expected but still good quality.',
                'date' => '1 month ago'
            ]
        ]
    ],

    //Product 13
    [
        'name' => 'Wall Mounted Floating Shelf',
        'price' => '₱299.00',
        'image' => '../../image/home-living/Wall Mounted Floating Shelf.jpeg',
        'link' => 'view-product.php?id=513',
        'discount' => '-20%',
        'variants' => [
            'Small 30cm' => 'https://via.placeholder.com/400x400/8b6f47/996633?text=Small+30cm',
            'Medium 60cm' => 'https://via.placeholder.com/400x400/a0826d/cc9966?text=Medium+60cm',
            'Large 90cm' => 'https://via.placeholder.com/400x400/d2b48c/cc9966?text=Large+90cm'
        ],
        'description' => 'Modern floating shelf for organizing and displaying items without visible brackets. Adds elegant storage to any wall.',
        'reviews' => [
            [
                'reviewer_name' => 'Dorothy Stewart',
                'rating' => 5,
                'comment' => 'Beautiful floating shelf! Installation was easy and it looks great. Very sturdy too!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Paul Morris',
                'rating' => 5,
                'comment' => 'Excellent floating shelf! Professional look and supports weight well. Highly recommend!',
                'date' => '1 month ago'
            ],
            [
                'reviewer_name' => 'Marion Rogers',
                'rating' => 4,
                'comment' => 'Good shelf but installation could be tricky. Worth it for the clean look though.',
                'date' => '2 months ago'
            ]
        ]
    ],

    //Product 14
    [
        'name' => 'Bathroom Shower Caddy Organizer',
        'price' => '₱299',
        'image' => '../../image/home-living/Bathroom Shower Caddy Organizer.jpeg',
        'link' => 'view-product.php?id=514',
        'discount' => '-20%',
        'variants' => [
            'White' => 'https://via.placeholder.com/400x400/f5f5f5/cccccc?text=White',
            'Gray' => 'https://via.placeholder.com/400x400/a9a9a9/999999?text=Gray',
            'Stainless Steel' => 'https://via.placeholder.com/400x400/c0c0c0/999999?text=Stainless'
        ],
        'description' => 'Rust-resistant shower caddy for organizing bathroom essentials. Space-saving design with strong suction cups.',
        'reviews' => [
            [
                'reviewer_name' => 'Rose Ward',
                'rating' => 5,
                'comment' => 'Perfect shower caddy! Suction cups hold tight and it keeps my shower organized nicely!',
                'date' => '1 week ago'
            ],
            [
                'reviewer_name' => 'Arthur Powell',
                'rating' => 5,
                'comment' => 'Excellent caddy! Rust resistant and very sturdy. Great for organization!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Ethel Long',
                'rating' => 4,
                'comment' => 'Good shower caddy but suction cups don\'t stick on all tile types.',
                'date' => '1 month ago'
            ]
        ]
    ],

    //Product 15
    [
        'name' => 'Tabletop Indoor Plant (Artificial)',
        'price' => '₱299',
        'image' => '../../image/home-living/Tabletop Indoor Plant (Artificial).jpeg',
        'link' => 'view-product.php?id=515',
        'discount' => '-20%',
        'variants' => [
            'Small Fern' => 'https://via.placeholder.com/400x400/228b22/33cc33?text=Small+Fern',
            'Medium Ivy' => 'https://via.placeholder.com/400x400/2e8b57/33ff66?text=Medium+Ivy',
            'Large Palm' => 'https://via.placeholder.com/400x400/3cb371/33ff66?text=Large+Palm'
        ],
        'description' => 'Realistic artificial indoor plant for decoration without maintenance. Perfect for adding greenery to any room.',
        'reviews' => [
            [
                'reviewer_name' => 'Judith Fisher',
                'rating' => 5,
                'comment' => 'Beautiful artificial plant! Looks so realistic and requires no care. Perfect for my office!',
                'date' => '2 weeks ago'
            ],
            [
                'reviewer_name' => 'Russell Mason',
                'rating' => 5,
                'comment' => 'Excellent artificial plant! Very lifelike and great quality. Love it!',
                'date' => '1 month ago'
            ],
            [
                'reviewer_name' => 'Ida Clarke',
                'rating' => 4,
                'comment' => 'Nice artificial plant but dust can be hard to clean. Still looks great!',
                'date' => '2 months ago'
            ]
        ]
    ]
];

// Append dynamic products from `products` table (including Core 3 synced items)
include_once '../../Database/config.php';

if (isset($conn) && !$conn->connect_error) {
    $sql = "
        SELECT id, name, price, image_url, description, category, core3_category
        FROM products
        WHERE status = 'Active'
          AND (
              category = 'Home & Living'
              OR core3_category = 'Home & Living'
          )
        ORDER BY id DESC
        LIMIT 20
    ";

    if ($result = $conn->query($sql)) {
        while ($row = $result->fetch_assoc()) {
            $products[] = [
                'name' => $row['name'],
                'price' => '₱' . number_format((float)$row['price'], 2),
                'image' => !empty($row['image_url']) ? $row['image_url'] : '../../image/home-living/Decorative%20Throw%20Pillow%20Set.jpeg',
                'link' => '#',
                'discount' => '-10%',
                'variants' => [],
                'description' => !empty($row['description'])
                    ? $row['description']
                    : 'Approved marketplace product from Core 3 (Home & Living).',
                'reviews' => []
            ];
        }
        $result->free();
    }
}
?>

<div class="product-grid">
    <?php foreach ($products as $product): ?>
        <div class="product-card" 
            data-name="<?php echo htmlspecialchars($product['name']); ?>"
            data-image="<?php echo $product['image']; ?>"
            data-variants='<?php echo htmlspecialchars(json_encode($product['variants'] ?? [])); ?>'
            onclick="window.location.href='<?php echo $product['link']; ?>'">
            <div class="image-wrapper">
                <?php if (isset($product['discount'])): ?>
                    <span class="discount-badge"><?php echo $product['discount']; ?></span>
                <?php endif; ?>
                <img src="<?php echo str_replace(' ', '%20', $product['image']); ?>" alt="<?php echo htmlspecialchars($product['name']); ?>" class="product-img">
                <div class="variant-swatches" aria-hidden="true" onclick="event.stopPropagation();"></div>
            </div>
            <div class="product-details">
                <h3 class="product-title">
                    <?php echo htmlspecialchars($product['name']); ?>
                </h3>
                <?php if (isset($product['description'])): ?>
                    <p class="product-description"><?php echo htmlspecialchars(substr($product['description'], 0, 80)) . '...'; ?></p>
                <?php endif; ?>
                <?php if (isset($product['reviews']) && !empty($product['reviews'])): ?>
                    <div class="product-rating">
                        <div class="stars">
                            <?php 
                                $avgRating = array_sum(array_map(function($r) { return $r['rating']; }, $product['reviews'])) / count($product['reviews']);
                                $fullStars = floor($avgRating);
                                for ($i = 0; $i < 5; $i++) {
                                    echo $i < $fullStars ? '⭐' : '☆';
                                }
                            ?>
                        </div>
                        <span class="review-count">(<?php echo count($product['reviews']); ?> reviews)</span>
                    </div>
                <?php endif; ?>
            </div>
            <div class="card-action-area">
                <div class="product-price"><?php echo $product['price']; ?></div>
                <a href="#" class="add-to-cart-btn" onclick="event.stopPropagation(); return false;">Find Similar</a>
            </div>
        </div>
    <?php endforeach; ?>
</div>
